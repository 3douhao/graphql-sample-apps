fragment postData on Post {
  id
  title
  text
  tags
  datePublished
  likes
  category {
    id
    name
  }
  author {
    username
    displayName
    avatarImg
  }
  comments {
    id
    text
    commentsOn {
      comments {
        id
        text
        author {
          username
          displayName
          avatarImg
        }
      }
    }
    author {
      username
      displayName
      avatarImg
    }
  }
}

query allPosts {
  queryPost(order: { desc: datePublished }) {
    ...postData
  }
}

query getPost($id: ID!) {
  getPost(id: $id) {
    ...postData
  }
}

query getUser($username: String!) {
  getUser(username: $username) {
    username
    displayName
    avatarImg
  }
}

query allCategories{
  queryCategory {
    id
    name
  }
}

mutation addPost($post: AddPostInput!) {
  addPost(input: [$post]) {
    post {
      id
    }
  }
}

mutation addComment($comment: AddCommentInput!) {
  addComment(input: [$comment]) {
    comment {
      id
      text
      author {
        username
        displayName
      }
    }
  }
}

mutation updateUser($username: String!, $user: UserPatch) {
  updateUser(input: {filter: {username: {eq: $username}}, set: $user}) {
    user {
      displayName
      avatarImg
    }
  }
}

mutation updatePost($id: ID!, $post: PostPatch) {
  updatePost(input: { filter: { id: [$id] }, set: $post }) {
    post {
      ...postData
    }
  }
}